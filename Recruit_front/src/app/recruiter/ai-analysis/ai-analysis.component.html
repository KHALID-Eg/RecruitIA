<div class="ai-analysis-container">
  <div class="header">
    <h1>ğŸ¤– AI Analysis - {{ offer?.title }}</h1>
    <p>Automated candidate screening and ranking</p>
  </div>

  <div *ngIf="loading" class="loading">
    <p>Analyze candidates...</p>
  </div>

  <div *ngFor="let item of analyzedCandidates" class="candidate-card">
    <div class="candidate-info">
      <h3>{{ item.application.candidateEmail }}</h3>
      <p>Applied on: {{ item.application.applicationDate | date }}</p>

      <div *ngIf="item.aiResult" class="analysis-results">
        <div class="score-badge">
          <span class="score-value" [ngClass]="getScoreClass(item.aiResult.matchScore)">
            {{ item.aiResult.matchScore | number:'1.0-1' }}%
          </span>
          <span class="score-label">Match</span>
        </div>

        <div class="category-tag">
          ğŸ“‚ {{ item.aiResult.category }}
        </div>

        <div class="skills-list">
          <span *ngFor="let skill of item.aiResult.extractedSkills" class="skill-badge">
            {{ skill }}
          </span>
        </div>
      </div>
      
      <div *ngIf="!item.aiResult && !item.analyzing" style="color: grey; font-style: italic;">
        Not analyzed yet
      </div>
       <div *ngIf="item.analyzing" style="color: grey; font-style: italic;">
        Analyzing...
      </div>
    </div>

    <div class="actions">
      <button *ngIf="!item.aiResult" 
              class="btn btn-analyze" 
              (click)="analyzeSingleCandidate(item)"
              [disabled]="item.analyzing">
        âš¡ Analyze
      </button>

      <div *ngIf="item.application.status === 'PENDING' && item.aiResult">
        <button class="btn btn-accept" (click)="acceptCandidate(item.application.id)">
          âœ… Accept
        </button>
        <button class="btn btn-reject" (click)="rejectCandidate(item.application.id)">
          âŒ Reject
        </button>
      </div>
       <div *ngIf="item.application.status !== 'PENDING'" class="status-badge">
        Status: {{ item.application.status }}
      </div>
    </div>
  </div>

  <div *ngIf="analyzedCandidates.length === 0 && !loading" style="text-align: center; color: #666;">
    No applications found for this offer.
  </div>
</div>
